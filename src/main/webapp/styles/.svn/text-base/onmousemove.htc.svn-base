<PUBLIC:ATTACH EVENT="onmousemove" ONEVENT="domEventAop()" />
<SCRIPT LANGUAGE="JScript">

/*
    当鼠标在form上移动时，修改form的submit方法
*/
function domEventAop()
{
    var frms = window.document.forms;
    for(var i = 0; i < window.document.forms.length; i++)
    {
        if (frms[i].attatch)
            return;
        frms[i].baseSubmit = frms[i].submit; //保存表单原来的submit 方法
        frms[i].submited = false; //添加一个submited属性，并且设置其为false
        frms[i].attatch = true;
        try
	    {
        	frms[i].submit = new Function("$submitForm(this)");
        	$addElementEventHandler(frms[i], "onsubmit", "$submitForm(window.document.forms[" + i + "])");
	    }
	    catch(e)
	    {
        	$addElementEventHandler(frms[i], "submit", "$submitForm(window.document.forms[" + i + "])");
	        
	    }
    }
}

/*
    提交一个表单，如果当前表单已经提交，那么就不会继续提交该表单
*/
function $submitForm(frm)
{
    if (frm.submited)
    {
        alert("不能重复提交页面！");
        return;
    }

    frm.submited = true;
    try
    {
        loadingMsg("请求处理中，请稍候...")
    }
    catch(e)
    {
        //alert("loadingMsg err + " + e);
        ;//do nothing
    }

    frm.baseSubmit();
} 
 
/*
    添加一个方法到到一个对象的一个的一个事件中
    element 要设置的对象
    eventName 事件名称，字符串类型的
    methodName 表示函数名称，字符串类型的
*/
function $addElementEventHandler(element, eventName, methodName)
{
    element.attachEvent(eventName, new Function(methodName));
}

</SCRIPT> 